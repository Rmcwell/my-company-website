---
import Layout from "../layouts/Layout.astro";
import Heading from "../components/ui/Heading.astro";
import Text from "../components/ui/Text.astro";
import Section from "../components/ui/Section.astro";
import SectionLabel from "../components/ui/SectionLabel.astro";
import Button from "../components/ui/Button.astro";

interface Step {
  number: string;
  title: string;
  desc: string;
  details: string[];
}

const steps: Step[] = [
  {
    number: '01',
    title: 'Discovery & Planning',
    desc: 'We start by understanding your business goals, target audience, and technical requirements. We map out the entire project scope to avoid surprises later.',
    details: [
      'Stakeholder Interviews',
      'Requirements Gathering',
      'Technical Feasibility',
      'Project Roadmap',
    ],
  },
  {
    number: '02',
    title: 'Design & Architecture',
    desc: 'We create the visual identity and technical blueprint. This includes wireframes, high-fidelity mockups, and database schema design.',
    details: [
      'UI/UX Design',
      'System Architecture',
      'Prototyping',
      'Tech Stack Selection',
    ],
  },
  {
    number: '03',
    title: 'Development',
    desc: "Our engineers get to work building your solution using clean, scalable code. We work in sprints with regular check-ins so you're always in the loop.",
    details: [
      'Frontend & Backend Dev',
      'API Integration',
      'Code Reviews',
      'Sprint Demos',
    ],
  },
  {
    number: '04',
    title: 'Testing & QA',
    desc: 'We rigorously test everything across devices and browsers. We check for bugs, performance bottlenecks, and security vulnerabilities.',
    details: [
      'Unit & Integration Testing',
      'Cross-browser Testing',
      'Performance Audits',
      'Security Scanning',
    ],
  },
  {
    number: '05',
    title: 'Launch & Support',
    desc: 'We handle the deployment process to ensure a smooth go-live. After launch, we provide ongoing support and maintenance.',
    details: [
      'Deployment Strategy',
      'DNS Configuration',
      'Training',
      '24/7 Monitoring',
    ],
  },
];
---

<Layout>
  <Section bg="navy" class="text-center">
    <div
      class="absolute inset-0 opacity-10 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')]"
    />
    <SectionLabel>Our Process</SectionLabel>
      <Heading as="h1" class="text-white mb-6">
        How We Work
      </Heading>
      <Text class="text-slate-300">
        A transparent, collaborative approach designed to deliver excellence
        on time and on budget.
      </Text>
  </Section>

  <Section bg="light">
    <div class="max-w-5xl mx-auto">
      <div class="space-y-16">
        {steps.map((step, index) => (
          <div
            class="relative opacity-0 translate-y-5 transition-all duration-700 ease-out data-[in-view]:opacity-100 data-[in-view]:translate-y-0"
            data-in-view={false}
            style={`transition-delay: ${index * 0.1}s;`}
          >
            <div class="flex gap-8 items-start">
              <!-- Timeline marker -->
              <div class="relative flex flex-col items-center shrink-0">
                <div class="w-16 h-16 bg-white border-4 border-gold rounded-full shadow-lg flex items-center justify-center z-10">
                  <span class="text-navy font-bold text-lg">
                    {step.number}
                  </span>
                </div>
                {index < steps.length && (
                  <div class="w-[2px] h-full bg-gold/30 absolute top-16"></div>
                )}
              </div>

              <!-- Content -->
              <div class="flex-1 bg-white p-8 rounded-lg shadow-md border-l-4 border-teal hover:shadow-xl transition-shadow">
                <h3 class="text-2xl font-bold text-navy mb-4">
                  {step.title}
                </h3>
                <p class="text-slate-600 mb-6 leading-relaxed">
                  {step.desc}
                </p>

                <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                  {step.details.map((detail) => (
                    <div class="flex items-center space-x-2 text-sm text-slate-500">
                      <span class="w-1.5 h-1.5 bg-teal rounded-full"></span>
                      <span>{detail}</span>
                    </div>
                  ))}
                </div>
              </div>
            </div>
          </div>
        ))}
      </div>
    </div>
  </Section>

  <Section bg="navy" class="text-center" paddingBottom>
    <Heading class="text-white mb-6">Ready to get started?</Heading>
    <a href="/contact">
      <Button variant="primary" size="lg">
        Get a Quote
      </Button>
    </Link>
  </Section>
</Layout>

<script>
  // Intersection Observer for scroll-triggered animations (replaces framer-motion whileInView)
  const observerOptions = {
    threshold: 0.1,
    rootMargin: '0px 0px -50px 0px'
  };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.setAttribute('data-in-view', 'true');
        // Optional: unobserve after animation
        // observer.unobserve(entry.target);
      }
    });
  }, observerOptions);

  document.querySelectorAll('[data-in-view]').forEach(el => {
    observer.observe(el);
  });
</script>

<style>
  /* Optional: Custom Tailwind-compatible animations if needed */
</style>
